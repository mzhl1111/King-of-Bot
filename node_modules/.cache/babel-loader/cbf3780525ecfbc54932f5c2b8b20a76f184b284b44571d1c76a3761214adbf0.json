{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport ContentCard from \"@/components/ContentCard.vue\";\nimport { useStore } from \"vuex\";\nimport $ from \"jquery\";\nimport { ref } from \"vue\";\nimport router from \"@/router/index\";\nexport default {\n  components: {\n    ContentCard\n  },\n  setup() {\n    const store = useStore();\n    let replays = ref([]);\n    let current_page = 1;\n    let total_replays = 0;\n    let max_pages = 0;\n    let prev_disabled = ref();\n    let next_disabled = ref();\n    let pages = ref([]);\n    const click_page = page => {\n      if (page === -2) page = current_page - 1;\n      if (page === -1) page = current_page + 1;\n      if (page >= 1 && page <= max_pages) {\n        pull_page(page);\n      }\n    };\n    const update_pages = () => {\n      let new_pages = [];\n      for (let i = current_page - 2; i <= current_page + 2; i++) {\n        if (i >= 1 && i <= max_pages) {\n          new_pages.push({\n            number: i,\n            is_active: i === current_page ? \"active\" : \"inactive\"\n          });\n        }\n      }\n      pages.value = new_pages;\n    };\n    const pull_page = page => {\n      current_page = page;\n      $.ajax({\n        url: \"http://localhost:8888/replay/getlist/\",\n        data: {\n          page\n        },\n        type: \"GET\",\n        headers: {\n          Authorization: \"Bearer \" + store.state.user.token\n        },\n        success(resp) {\n          replays.value = resp.replays;\n          total_replays = resp.replays_count;\n          max_pages = parseInt(Math.ceil(total_replays / 10));\n          prev_disabled = 1 === current_page ? \"page-item disabled\" : \"page-item \";\n          next_disabled = max_pages === current_page ? \"page-item disabled\" : \"page-item \";\n          console.log(prev_disabled);\n          console.log(next_disabled);\n          update_pages();\n        },\n        error(resp) {\n          console.log(resp);\n        }\n      });\n    };\n    pull_page(current_page);\n    const open_replay_content = replayId => {\n      for (const replay of replays.value) {\n        if (replay.replay.id === replayId) {\n          console.log(replay);\n          store.commit(\"updateIsReplay\", true);\n          const map2d = JSON.parse(replay.replay.map).map(innerArray => innerArray.map(Number));\n          store.commit(\"updateGame\", {\n            map: map2d,\n            a_id: replay.replay.aid,\n            a_sx: replay.replay.asx,\n            a_sy: replay.replay.asy,\n            b_id: replay.replay.bid,\n            b_sx: replay.replay.bsx,\n            b_sy: replay.replay.bsy\n          });\n          store.commit(\"updateSteps\", {\n            a_steps: replay.replay.asteps,\n            b_steps: replay.replay.bsteps\n          });\n          console.log(replay.replay.loser);\n          store.commit(\"updateReplayLoser\", replay.replay.loser);\n          router.push({\n            name: \"replay_content\",\n            params: {\n              replayId\n            }\n          });\n          break;\n        }\n      }\n    };\n    return {\n      replays,\n      total_replays,\n      max_pages,\n      open_replay_content,\n      pages,\n      prev_disabled,\n      next_disabled,\n      click_page\n    };\n  }\n};","map":{"version":3,"names":["ContentCard","useStore","$","ref","router","components","setup","store","replays","current_page","total_replays","max_pages","prev_disabled","next_disabled","pages","click_page","page","pull_page","update_pages","new_pages","i","push","number","is_active","value","ajax","url","data","type","headers","Authorization","state","user","token","success","resp","replays_count","parseInt","Math","ceil","console","log","error","open_replay_content","replayId","replay","id","commit","map2d","JSON","parse","map","innerArray","Number","a_id","aid","a_sx","asx","a_sy","asy","b_id","bid","b_sx","bsx","b_sy","bsy","a_steps","asteps","b_steps","bsteps","loser","name","params"],"sources":["/Users/muzhouliu/Desktop/acwing/kob/web/src/views/replay/replayIndexView.vue"],"sourcesContent":["<template>\n    <ContentCard>\n        <table class=\"table table-hover\">\n            <thead>\n                <th> A</th>\n                <th> B</th>\n                <th> Match Result </th>\n                <th> Time </th>\n                <th> ... </th>\n            </thead>\n            <tbody>\n                <tr v-for=\"replay in replays\" :key=\"replay.replay.id\">\n                    <td>\n                        <img :src=\"replay.a_photo\" alt=\"\" class=\"replay-user-photo\">\n                        &nbsp;\n                        <span class=\"replay-user-username\">{{ replay.a_username }}</span>\n                    </td>\n                    <td>\n                        <img :src=\"replay.b_photo\" alt=\"\" class=\"replay-user-photo\">\n                        &nbsp;\n                        <span class=\"replay-user-username\">{{ replay.b_username }}</span>\n                    </td>\n                    <td>\n                        {{replay.result}}\n                    </td>\n                    <td>\n                        {{replay.replay.createTime}}\n                    </td>\n                    <td>\n                        <button @click=\"open_replay_content(replay.replay.id)\" class=\"btn btn-primary\">Watch the replay</button>\n                    </td>\n                </tr>    \n            </tbody>\n        </table>\n\n        <nav aria-label=\"...\">\n            <ul class=\"pagination\" style=\"float: right\">\n                <li class=\"\" @click=\"click_page(-2)\">\n                    <a class=\"page-link\" href=\"#\">Previous</a>\n                </li>\n                <li :class=\"'page_item ' + page.is_active\" v-for=\"page in pages\" :key=\"page.number\" @click=\"click_page(page.number)\">\n                    <a class=\"page-link\" href=\"#\"> {{ page.number }}</a>\n                </li>\n                <li :class=\"next_disabled\" @click=\"click_page(-1)\">\n                <a class=\"page-link\" href=\"#\">Next</a>\n                </li>\n            </ul>\n        </nav>\n    </ContentCard>\n</template>\n\n<script>\nimport ContentCard from \"@/components/ContentCard.vue\";\nimport { useStore } from \"vuex\";\nimport $ from \"jquery\";\nimport { ref } from \"vue\";\nimport router from \"@/router/index\"\n\nexport default {\n    components: {\n        ContentCard\n    },\n    setup() {\n        const store = useStore();\n        let replays = ref([]);\n        let current_page = 1;\n        let total_replays = 0;\n        let max_pages = 0;\n        let prev_disabled = ref();\n        let next_disabled = ref();\n        let pages = ref([]);\n\n        const click_page = page => {\n            if (page === -2) page = current_page - 1;\n            if (page === -1) page = current_page + 1;\n            \n            if (page >= 1 && page <= max_pages) {\n                pull_page(page);\n            }\n        }\n\n        const update_pages = () => {\n            let new_pages = [];\n            for (let i = current_page - 2; i <= current_page + 2; i++) {\n                if (i >= 1 && i <= max_pages) {\n                    new_pages.push({\n                        number: i,\n                        is_active: i === current_page ? \"active\" : \"inactive\",\n                    });\n                }\n            }\n            pages.value = new_pages;\n        }\n\n\n        const pull_page = page => {\n            current_page = page;\n            $.ajax({\n                url: \"http://localhost:8888/replay/getlist/\",\n                data: {\n                    page,\n                },\n                type: \"GET\",\n                headers: {\n                    Authorization: \"Bearer \" + store.state.user.token,\n                },\n                success(resp) {\n                    replays.value = resp.replays;\n                    total_replays = resp.replays_count;\n                    max_pages = parseInt(Math.ceil(total_replays / 10));\n                    prev_disabled = 1 === current_page? \"page-item disabled\": \"page-item \";\n                    next_disabled = max_pages === current_page? \"page-item disabled\": \"page-item \";\n                    console.log(prev_disabled)\n                    console.log(next_disabled)\n                    update_pages();\n                },\n                error(resp) {\n                    console.log(resp);\n                }\n            })\n        }\n        pull_page(current_page);\n\n        const open_replay_content = replayId => {\n            for (const replay of replays.value) {\n                if (replay.replay.id === replayId) {\n                    console.log(replay)\n                    store.commit(\"updateIsReplay\", true);\n                    const map2d = JSON.parse(replay.replay.map).map(innerArray => innerArray.map(Number));\n                    store.commit(\"updateGame\", {\n                        map: map2d,\n                        a_id: replay.replay.aid,\n                        a_sx: replay.replay.asx,\n                        a_sy: replay.replay.asy,\n                        b_id: replay.replay.bid,\n                        b_sx: replay.replay.bsx,\n                        b_sy: replay.replay.bsy,\n                    });\n                    store.commit(\"updateSteps\", {\n                        a_steps: replay.replay.asteps,\n                        b_steps: replay.replay.bsteps,\n                    })\n                    console.log(replay.replay.loser)\n                    store.commit(\"updateReplayLoser\", replay.replay.loser)\n                    router.push({\n                        name: \"replay_content\",\n                        params: {\n                            replayId\n                        }\n                        \n                    })\n                    break;\n                }\n            }\n        }\n\n        return {\n            replays,\n            total_replays,\n            max_pages,\n            open_replay_content,\n            pages,\n            prev_disabled,\n            next_disabled,\n            click_page,\n        }   \n    }\n\n}\n\n</script>\n\n<style scoped>\nimg.replay-user-photo {\n    width: 4vh;\n    border-radius: 50%;\n\n}\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}